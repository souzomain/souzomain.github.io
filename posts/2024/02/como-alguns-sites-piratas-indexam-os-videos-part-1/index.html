<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="Análisando um site pirata que carrega seu conteúdo por meio de XSS e exploração em wordpress.
Em algum momento da sua vida você ja tentou entrar em algum site pirata, seja para assistir uma série, um filme ou um anime que voce gosta.
Alguns dias atrás eu estava a procura de um anime que não conseguia encontrar em lugar nenhum, então fui atrás de um desses sites duvidosos na internet."><meta name=keywords content=",hacking,xss"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://souzomain.github.io/posts/2024/02/como-alguns-sites-piratas-indexam-os-videos-part-1/><title>Como Alguns Sites Piratas Indexam Os Videos - Part 1 :: Souzomain Blog
</title><link rel=stylesheet href=https://souzomain.github.io/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE="><link rel=apple-touch-icon sizes=180x180 href=https://souzomain.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://souzomain.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://souzomain.github.io/favicon-16x16.png><link rel=manifest href=https://souzomain.github.io/site.webmanifest><link rel=mask-icon href=https://souzomain.github.io/safari-pinned-tab.svg color><link rel="shortcut icon" href=https://souzomain.github.io/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Como Alguns Sites Piratas Indexam Os Videos - Part 1"><meta itemprop=description content="Análisando um site pirata que carrega seu conteúdo por meio de XSS e exploração em wordpress.
Em algum momento da sua vida você ja tentou entrar em algum site pirata, seja para assistir uma série, um filme ou um anime que voce gosta.
Alguns dias atrás eu estava a procura de um anime que não conseguia encontrar em lugar nenhum, então fui atrás de um desses sites duvidosos na internet."><meta itemprop=datePublished content="2024-02-08T11:01:12-03:00"><meta itemprop=dateModified content="2024-02-08T11:01:12-03:00"><meta itemprop=wordCount content="425"><meta itemprop=keywords content="hacking,xss,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Como Alguns Sites Piratas Indexam Os Videos - Part 1"><meta name=twitter:description content="Análisando um site pirata que carrega seu conteúdo por meio de XSS e exploração em wordpress.
Em algum momento da sua vida você ja tentou entrar em algum site pirata, seja para assistir uma série, um filme ou um anime que voce gosta.
Alguns dias atrás eu estava a procura de um anime que não conseguia encontrar em lugar nenhum, então fui atrás de um desses sites duvidosos na internet."><meta property="og:title" content="Como Alguns Sites Piratas Indexam Os Videos - Part 1"><meta property="og:description" content="Análisando um site pirata que carrega seu conteúdo por meio de XSS e exploração em wordpress.
Em algum momento da sua vida você ja tentou entrar em algum site pirata, seja para assistir uma série, um filme ou um anime que voce gosta.
Alguns dias atrás eu estava a procura de um anime que não conseguia encontrar em lugar nenhum, então fui atrás de um desses sites duvidosos na internet."><meta property="og:type" content="article"><meta property="og:url" content="https://souzomain.github.io/posts/2024/02/como-alguns-sites-piratas-indexam-os-videos-part-1/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-02-08T11:01:12-03:00"><meta property="article:modified_time" content="2024-02-08T11:01:12-03:00"><meta property="article:published_time" content="2024-02-08 11:01:12 -0300 -03"><script async src="https://www.googletagmanager.com/gtag/js?id=G-6MXTFC4BDJ"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6MXTFC4BDJ",{anonymize_ip:!1})}</script></head><body><div class=container><header class=header><span class=header__inner><a href=https://souzomain.github.io/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd /home/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://souzomain.github.io/about/>About</a></li><li><a href=https://souzomain.github.io/posts/>Posts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
2 minutes</p></div><article><h1 class=post-title><a href=https://souzomain.github.io/posts/2024/02/como-alguns-sites-piratas-indexam-os-videos-part-1/>Como Alguns Sites Piratas Indexam Os Videos - Part 1</a></h1><div class=post-content><p>Análisando um site pirata que carrega seu conteúdo por meio de XSS e exploração em wordpress.</p><p>Em algum momento da sua vida você ja tentou entrar em algum site pirata, seja para assistir uma série, um filme ou um anime que voce gosta.</p><p>Alguns dias atrás eu estava a procura de um anime que não conseguia encontrar em lugar nenhum, então fui atrás de um desses sites duvidosos na internet.</p><p>Depois de uma boa pesquisada, consegui encontrar o site de animes que continha o que eu queria assistir. porém&mldr;</p><p>Ao clicar para assistir me deparei com a seguinte situação:</p><ul><li>O site me redireciona para um site terceiro;</li><li>O site terceiro me redireciona para outro site terceiro;</li><li>O conteúdo é apresentado em um site totalmente diferente do anime.</li></ul><p>Exemplo:</p><p><img src=images/img1.png alt="Imagem 1"></p><p>Reparem que o dominio do site não condiz com o dominio do anime, nem o título e nem o restante da URL, ou seja, está em um servidor totalmente diferente.
Se você tentar entrar no mesmo url, o conteúdo será totalmente diferente.</p><p>Caso você seja alguem que procura por sites alternativos como eu, ja deve ter se deparado com esse tipo de situação.</p><p>Mas, após ver isso, fiquei com várias dúvidas</p><ul><li>Por que eles estão utilizando outro site?</li><li>Como eles colocam um anime para iniciar em outro site?</li><li>De onde vem o conteúdo?</li></ul><p>O site em questão que irei análisar é o <a href=https://animetvonline.cx>animetvonline</a></p><h2 id=iniciando-a-análise>Iniciando a análise</h2><hr><p>Iniciando a análise dei uma verificada no código fonte para tentar obter o local do arquivo de carrega o site terceiro para entregar o vídeo.</p><p>Encontrei o seguinte código da página:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://flufc.com.br/noticia.php?token=PGRpdiBpZD0iZW1iZWRfaG9sZGVyIiBjbGFzcz0ibG93dmlkIj48ZGl2IGNsYXNzPSJwbGF5ZXItZW1iZWQiIGlkPSJwZW1iZWQiPjxpZnJhbWUgc3JjPSJodHRwczovL2dlcmFkb3IubXlhbmltZXllcy5uZXQvdG9rZW4vZW1iZWQucGhwP2RhdGE9cTk2RjdqZHEyUUZkUmlUK1lhYUZDbXlaSHVlVERMQm5vanVscCtqWVFYWXorcXg5dUZ3ZzJpVjBaYUJYTWtBenYwK3FzY2RnQXFDbHVtQkx0ck1GcWR3ZEE2TFhLbmVaSmZXbnpRcHRaZk8rejVVdlM0UVR4VkZuVFFPTUJnMGE3S1V0Q2lQUTUwRGhkaVMwRFpkVThveXp1WURiOUJGM3JCRFk3RnZEWTJ3ZDU2TW5hdnowNGRURGZKajIzMDJvU0NIaEgvK1ZFNVYwOWtWTnBQYzQ0NENJeFI3QlhzNUVFZW1kYzJCeE9ob1ordGpTT0ZQUVFJeDlFczVyRmFZanV1a21RQ2QrVXZjWVlIbmxvRlRleTJqQ0NBYjVrTE1lMlhsSE1pSHBTR05xIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmcmFtZWJvcmRlcj0iMCIgYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPjwvZGl2PjwvZGl2PiA=&#34;</span> <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_blank&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ClassLink&#34;</span>&gt;
</span></span></code></pre></div><p>Parece que o site pirata utiliza apenas um link para o site terceiro.</p><p>Interessante se atentar que o site terceiro utilizado é o site do fluminence, como mostra a imagem abaixo.</p><p><img src=images/img2.png alt="Imagem 2: site do fluminence"></p><p>Análisando o link vi que o site de animes está usando passando um &ldquo;token&rdquo; como parâmetro ao site tereceiro. Aparentemente o token contém um código base64.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>PGRpdiBpZD0iZW1iZWRfaG9sZGVyIiBjbGFzcz0ibG93dmlkIj48ZGl2IGNsYXNzPSJwbGF5ZXItZW1iZWQiIGlkPSJwZW1iZWQiPjxpZnJhbWUgc3JjPSJodHRwczovL2dlcmFkb3IubXlhbmltZXllcy5uZXQvdG9rZW4vZW1iZWQucGhwP2RhdGE9cTk2RjdqZHEyUUZkUmlUK1lhYUZDbXlaSHVlVERMQm5vanVscCtqWVFYWXorcXg5dUZ3ZzJpVjBaYUJYTWtBenYwK3FzY2RnQXFDbHVtQkx0ck1GcWR3ZEE2TFhLbmVaSmZXbnpRcHRaZk8rejVVdlM0UVR4VkZuVFFPTUJnMGE3S1V0Q2lQUTUwRGhkaVMwRFpkVThveXp1WURiOUJGM3JCRFk3RnZEWTJ3ZDU2TW5hdnowNGRURGZKajIzMDJvU0NIaEgvK1ZFNVYwOWtWTnBQYzQ0NENJeFI3QlhzNUVFZW1kYzJCeE9ob1ordGpTT0ZQUVFJeDlFczVyRmFZanV1a21RQ2QrVXZjWVlIbmxvRlRleTJqQ0NBYjVrTE1lMlhsSE1pSHBTR05xIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmcmFtZWJvcmRlcj0iMCIgYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPjwvZGl2PjwvZGl2PiA<span style=color:#f92672>=</span>
</span></span></code></pre></div><p>Ao decodificar o token base64, obtive o um código html.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;embed_holder&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;lowvid&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;player-embed&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pembed&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>iframe</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://gerador.myanimeyes.net/token/embed.php?data=q96F7jdq2QFdRiT+YaaFCmyZHueTDLBnojulp+jYQXYz+qx9uFwg2iV0ZaBXMkAzv0+qscdgAqClumBLtrMFqdwdA6LXKneZJfWnzQptZfO+z5UvS4QTxVFnTQOMBg0a7KUtCiPQ50DhdiS0DZdU8oyzuYDb9BF3rBDY7FvDY2wd56Mnavz04dTDfJj2302oSCHhH/+VE5V09kVNpPc444CIxR7BXs5EEemdc2BxOhoZ+tjSOFPQQIx9Es5rFaYjuukmQCd+UvcYYHnloFTey2jCCAb5kLMe2XlHMiHpSGNq&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100%&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100%&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>frameborder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>allowfullscreen</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>iframe</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span></code></pre></div><h3 id=o-que-isso-significa>O que isso significa?</h3><hr><p>Parece que estão explorando uma vulnerabilidade de XSS para poder carregar o seu conteúdo em um site terceiro.</p><p>Para confirmar se há uma exploração, simplesmente criei um html e o transformei em base64.</p><p><img src=images/img3.png alt="Imagem 3: Criando um base64 simples"></p><p>Após isso, basta colocar o código html gerado no parametro &ldquo;token&rdquo; e vualá!</p><p><img src=images/img4.png alt="Imagem 4: confirmando a exploração"></p><p>A exploração foi confirmada, mas &mldr;</p><p>Explorou em outro site? O dominio é diferente? Como assim???</p><p>Fiquem atentos para a parte 2 :)</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://souzomain.github.io/tags/hacking/>hacking</a></span>
<span class=tag><a href=https://souzomain.github.io/tags/xss/>xss</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
425 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2024-02-08 11:01</p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2024</span>
<span><a href=https://souzomain.github.io></a></span><span><a href=https://souzomain.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by @souzomain</span></div></div></footer></div><script type=text/javascript src=https://souzomain.github.io/bundle.min.ac2a4bcaed631ec2dc154407be7f09fc28da37de71fae6dee6711b2a3d1622770f87d3cda22c460e9a68ff619bdb1dd75cb7a5d33f159a54e419736cc4541087.js integrity="sha512-rCpLyu1jHsLcFUQHvn8J/CjaN95x+ube5nEbKj0WIncPh9PNoixGDppo/2Gb2x3XXLel0z8VmlTkGXNsxFQQhw=="></script></body></html>